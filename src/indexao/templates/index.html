{% extends "base.html" %}

{% set active_page = "upload" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
        
        <!-- Upload Card -->
        <div class="card">
            <h2>
                <i class="fas fa-file-upload"></i>
                Upload Document
            </h2>
            <p>
                Formats acceptés: PDF, PNG, JPG, JPEG, TIFF, TXT
            </p>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <p style="font-size: 1.1em; margin-bottom: 0.5rem; color: var(--text-primary);">
                    Glissez-déposez un fichier ici
                </p>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">ou</p>
                <input type="file" id="fileInput" style="display: none;" 
                       accept=".pdf,.png,.jpg,.jpeg,.tiff,.txt">
                <button onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-folder-open"></i>
                    Choisir un fichier
                </button>
            </div>
            
            <!-- Upload Progress -->
            <div id="uploadProgress" class="upload-progress" style="display: none;">
                <div class="progress-header">
                    <h3 id="progressTitle">Upload en cours...</h3>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div id="progressStatus" class="progress-status"></div>
                
                <!-- Processing Stages -->
                <div id="processingStages" class="processing-stages" style="display: none;">
                    <div class="stage" id="stage-upload">
                        <i class="fas fa-upload"></i>
                        <span>Upload</span>
                        <i class="fas fa-spinner fa-spin stage-spinner"></i>
                        <i class="fas fa-check stage-check" style="display: none;"></i>
                    </div>
                    <div class="stage" id="stage-detection">
                        <i class="fas fa-file-search"></i>
                        <span>Détection</span>
                        <i class="fas fa-spinner fa-spin stage-spinner" style="display: none;"></i>
                        <i class="fas fa-check stage-check" style="display: none;"></i>
                    </div>
                    <div class="stage" id="stage-extraction">
                        <i class="fas fa-file-alt"></i>
                        <span>Extraction</span>
                        <i class="fas fa-spinner fa-spin stage-spinner" style="display: none;"></i>
                        <i class="fas fa-check stage-check" style="display: none;"></i>
                    </div>
                    <div class="stage" id="stage-translation">
                        <i class="fas fa-language"></i>
                        <span>Traduction</span>
                        <i class="fas fa-spinner fa-spin stage-spinner" style="display: none;"></i>
                        <i class="fas fa-check stage-check" style="display: none;"></i>
                    </div>
                    <div class="stage" id="stage-indexing">
                        <i class="fas fa-database"></i>
                        <span>Indexation</span>
                        <i class="fas fa-spinner fa-spin stage-spinner" style="display: none;"></i>
                        <i class="fas fa-check stage-check" style="display: none;"></i>
                    </div>
                </div>
                
                <button id="progressClose" onclick="closeProgress()" style="display: none; margin-top: 1rem;">
                    <i class="fas fa-times"></i>
                    Fermer
                </button>
            </div>
        </div>
        
        <!-- Config Card -->
        <div class="card">
            <h2>
                <i class="fas fa-info-circle"></i>
                Current Configuration
            </h2>
            <div class="config-grid">
                <div class="config-item">
                    <div class="config-label">OCR Engine</div>
                    <div class="config-value">
                        <i class="fas fa-eye"></i>
                        {{ config.ocr_engine }}
                    </div>
                </div>
                <div class="config-item">
                    <div class="config-label">Translator</div>
                    <div class="config-value">
                        <i class="fas fa-language"></i>
                        {{ config.translator_engine }}
                    </div>
                </div>
                <div class="config-item">
                    <div class="config-label">Search Engine</div>
                    <div class="config-value">
                        <i class="fas fa-search"></i>
                        {{ config.search_engine }}
                    </div>
                </div>
                <div class="config-item">
                    <div class="config-label">Languages</div>
                    <div class="config-value">
                        <i class="fas fa-globe"></i>
                        {{ config.languages|join(', ') }}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Files Card -->
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 style="margin: 0;">
                    <i class="fas fa-folder"></i>
                    Uploaded Files
                </h2>
                <div>
                    <button onclick="loadFiles()" style="margin-right: 0.5rem;">
                        <i class="fas fa-sync-alt"></i>
                        Rafraîchir
                    </button>
                    <button onclick="window.location.href='/documents'">
                        <i class="fas fa-list"></i>
                        Voir tout
                    </button>
                </div>
            </div>
            <div id="fileList" class="file-list">
                <p style="color: var(--text-secondary);">Chargement...</p>
            </div>
        </div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/app.js?v=1.0.1"></script>
{% endblock %}
